---
title: "AI-naloga-unfinished"
output:
  pdf_document: default
  html_notebook: default
---

## Obdelava podatkov in dodajanje atributov

Na začetku uvozimo podatke z gumbom v RStudio imenovanem "Import Dataset" in sicer izberemo opcijo "From Text(base)". Nato ustvarimo novo delovno spremenljivko "data", da ostane prvotna spremenljivka nespremenjena. 


```{r}
dataSem1 <- read.csv("../../AI-naloga/dataSem1.txt", stringsAsFactors=TRUE)

data <- dataSem1
data$regija <- as.factor(data$regija)
data$namembnost <- as.factor(data$namembnost)
data$norm_poraba <- as.factor(data$norm_poraba)

head(data)
```

Atribute "regija", "namembnost" in "norm_poraba" faktoriziramo, da programski jezik razbere zalogo vrednosti. V tabeli zgoraj je prikazanih prvih nekaj vrstic. 

```{r}
data$datum <- as.Date(data$datum)
head(data)

```

Lastnost atributa "datum" nastavimo na <date>.

```{r}
library(lubridate)

newData <- week(data$datum)

data$teden <- newData

newNewData <- month(data$datum)
data$mesec <- newNewData

head(data)
```

V tem delu dodamo nova atributa "teden" in "mesec" za lažje nadaljno delo. Za pomoč uporabimo knjižnico "lubridate".

```{r}
library(chron)

x <- is.weekend(data$datum)
data$vikend <- x
```

Zgornja koda prikazuje kako dodamo atribut "vikend", ki ima vrednost TRUE, če je dan sobota ali nedelja, oziroma FALSE, če je delovni dan. Pomagamo si s knjižnico "chron".

```{r Ustvarjen atribut UNIX}
data$UNIX <- as.numeric(as.POSIXct(paste(data$datum, data$ura, sep=" ")))
```

Ustvarimo splošen atribut za čas, ki nam omogoča lažje sortiranje.

```{r}
a <- order(data$stavba, data$ura, data$UNIX)
sortedDF <- data[a,]
sortedDF
```

Dataframe sortiramo po številki stavbe, uri meritve in UNIX času.

```{r}
vect = vector()
starTemp = 0
uraMeritve = 0
for (row in 1:nrow(sortedDF))
{
  if(uraMeritve == sortedDF[row, "ura"]) {
    vect <- c(vect, starTemp)
  }
  else {
    uraMeritve = sortedDF[row, "ura"]
    vect <- c(vect, sortedDF[row, "temp_zraka"])
  }
  starTemp = sortedDF[row, "temp_zraka"]
}

```

```{r}
sortedDF$norm_poraba <- factor(sortedDF$norm_poraba, levels=c("ZELONIZKA", "NIZKA", "SREDNJA", "VISOKA", "ZELOVISOKA"))

sortedDF$prev_temp <- vect
head(sortedDF)
```

S kodo zgornjih dveh odlomkov vsaki meritvi v sortirani matriki poiščemo meritev temperature prejšnjega dne in ji le to dopišemo v poseben stolpec z atributi.

```{r}
vect = vector()
starTemp = 0
uraMeritve = 0
substract = 0
beginning = 0
stevec = 0
for (row in 1:nrow(sortedDF))
{
  if(beginning < row-7)
    stevec = row-7
  else
    stevec = beginning
  if(uraMeritve == sortedDF[row, "ura"]) {
    starTemp = 0
    #r <- which(sortedDF[, "stavba"] == sortedDF[row, "stavba"] & sortedDF[, "ura"] == sortedDF[row, "ura"] & sortedDF[, "datum"] == sortedDF[row, "datum"] - substract)
    for (i in stevec:(row-1))
      starTemp = starTemp + sortedDF[i, "temp_zraka"]
    avgTemp = starTemp / (row - stevec)
    vect <- c(vect, avgTemp)
  }
  else {
    beginning = row
    uraMeritve = sortedDF[row, "ura"]
    vect <- c(vect, sortedDF[row, "temp_zraka"])
  }
  starTemp = sortedDF[row, "temp_zraka"]
}
```

```{r}
sortedDF$temp_teden <- vect
head(sortedDF)
```

Z zanko se sprehodimo po vsaki meritvi v matriki in izračunamo povprečje največ zadnjih 7 meritev za isto stavbo ob isti uri. Povprečno temperaturo zapišemo v stolpec z imenom "temp_teden".


## Večinski razred

```{r}
plot(sortedDF$norm_poraba, main = "Porazdelitev primerov glede na normirano stopnjo porabe")
```

```{r}
summary(sortedDF$norm_poraba)
```
Večinski parameter je vrednost "SREDNJA", ki predstavlja 76.435 vrednosti od 206.785, kar je 0,3696 od celotne zaloge elementov.


## Odločitveno drevo

```{r}
library(dplyr)
library(rpart)

dt_list <- list()

for(m in 1:11) {
  tempDF <- filter(sortedDF, mesec <= m)
  
  drops <- c("poraba")
  tempDF <- tempDF[ , !(names(tempDF) %in% drops)]
  dt_list[[m]] <- rpart(norm_poraba ~ ., data = tempDF)
}
```
Za izluščenje le posameznega meseca se uporabi knjižnica "dplyr", kjer s pomočjo fukcije "filter" izluščimo le podatke določenega meseca.
Zgoraj so narejena drevesa za vseh 11 mesecev razen decembra, ki se samo testira.


```{r}
library(rpart.plot)

for(m in dt_list)
  rpart.plot(m)
```



```{r}
i = 1
predicted <- list()
for (dt in dt_list) {
  tempDF <- filter(sortedDF, mesec == i+1)
  predicted[[i]] <- predict(dt, tempDF, type = "class")
  i = i + 1
}
```

### Analiza odločitvenega drevesa
```{r}
# Tabela zmot
cat("Pravilnost rezultatov \n")
for(i in 1:11){
  cat("Mesec =", i+1, " ->  ")
  q <- filter(sortedDF, mesec == i+1)$norm_poraba == predicted[[i]]
  cat(mean(q))
  #tab <- table(predicted[[i]],filter(sortedDF, mesec == i+1)$norm_poraba)
  cat(" +/-", sd(q)/sqrt(length(q)), "\n")
}
```


```{r}
cat("Senzitivnost za 'SREDNJA'\n")
for(i in 1:11){
  cat("Mesec =", i+1, " ->  ")
  tab <- table(filter(sortedDF, mesec == i+1)$norm_poraba, predicted[[i]])
  cat(tab["SREDNJA", "SREDNJA"]/sum(tab["SREDNJA",]), "\n")
}
```



```{r}
cat("Specifičnost za 'SREDNJA'\n")
for(i in 1:11){
  cat("Mesec =", i+1, " ->  ")
  tab <- table(filter(sortedDF, mesec == i+1)$norm_poraba, predicted[[i]])
  cat((sum(tab)-sum(tab["SREDNJA",])-sum(tab[,"SREDNJA"])+tab["SREDNJA","SREDNJA"])/(sum(tab)-sum(tab[,"SREDNJA"])), "\n")
}
```


```{r}
cat("Preciznost za 'SREDNJA'\n")
for(i in 1:11){
  cat("Mesec =", i+1, " ->  ")
  tab <- table(filter(sortedDF, mesec == i+1)$norm_poraba, predicted[[i]])
  cat(tab["SREDNJA", "SREDNJA"]/sum(tab[,"SREDNJA"]), "\n")
}
```

```{r}
i = 1
predictedMat <- list()
for (dt in dt_list) {
  tempDF <- filter(sortedDF, mesec == i+1)
  predictedMat[[i]] <- predict(dt, tempDF, type = "prob")
  i = i + 1
}
col.order <- c("ZELONIZKA", "NIZKA", "SREDNJA", "VISOKA", "ZELOVISOKA")
head(predictedMat[[1]][,col.order])
```

```{r}
library(nnet)

observedMat <- list()
for (i in 1:11) {
  observedMat[[i]] <- class.ind(factor(filter(sortedDF, mesec == i+1)$norm_poraba, levels=c("ZELONIZKA", "NIZKA", "SREDNJA", "VISOKA", "ZELOVISOKA")))
}
head(observedMat[[1]])
```


```{r}
print("Barier's test", quote = F)
for(i in 1:11){
  cat("Mesec =", i+1, " ->  ")
  bar <- sum((observedMat[[i]] - predictedMat[[i]]) ^ 2) / nrow(predictedMat[[i]])
  cat(bar, "\n")
}
```

```{r}
p0 <- table(sortedDF$norm_poraba)/nrow(sortedDF)
cat("Trivialni model\n")
for(i in 1:11){
  cat("Mesec =", i+1, " ->  ")
  p0Mat <- matrix(rep(p0, times=nrow(observedMat[[i]])), nrow = nrow(observedMat[[i]]), byrow = T)
  colnames(p0Mat) <- names(p0)
  bar <- sum((observedMat[[i]] - p0Mat) ^ 2) / nrow(p0Mat)
  cat(bar, "\n")
}

```
> Tale trivialen model je kao boljša metoda kot pa najino drevo. To je treba še enkrat preverit, ker se ne sklada z rezultatom zgoraj. - Najbrž zaradi tega, ker so rezultati v p0Mat povprečje od vseh vrednosti, namesto primerljive učne vrednosti, kot so v posameznih učnih množicah, na katerih potem izdelamo odločitveno drevo

```{r Informacijska vsebina odgovora}
inf.score <- function(trainClass, testClass, predMat) {
  result <- 0
  priors <- table(trainClass) / length(trainClass)
  
  for (i in 1:nrow(predMat)) {
    p.prior <- priors[testClass[i]]
    p.posterior <- predMat[i, testClass[i]]
    
    if(p.posterior >= p.prior) {
      result <- result - log2(p.prior) + log2(p.posterior)
    }
    else
      result <- result + log2(1-p.prior) - log2(1-p.posterior)
  }
  
  result/nrow(predMat)
}
```

```{r}
cat("Informacijska vsebina odgovora\n")
for (i in 1:11) {
  cat("Mesec =", i+1, " ->  ")
  cat(inf.score(filter(sortedDF, mesec <= i)$norm_poraba, filter(sortedDF, mesec == i+1)$norm_poraba, predictedMat[[i]]), "\n")
}
```

```{r}
cat("Informacijska vsebina trivialnega modela\n")
for (i in 1:11) {
  cat("Mesec =", i+1, " ->  ")
  p0Mat <- matrix(rep(p0, times=nrow(filter(sortedDF, mesec == i+1))), nrow = nrow(filter(sortedDF, mesec == i+1)), byrow = T)
  cat(inf.score(filter(sortedDF, mesec <= i)$norm_poraba, filter(sortedDF, mesec == i+1)$norm_poraba, p0Mat), "\n")
}
```
> Spet podoben problem, kot zgoraj pri trivialnem modelu. Vse vrednosti bi morale biti 0, ampak najbrž niso zaradi napačnega izračuna povprečne porazdelitve v p0 in potem generirani matriki p0Mat











## Testni chunk

```{r}

```















# REGRESIJA                                     



## DEKLARACIJA FUNKCIJ ZA OCENJEVANJE 

```{r Funkcije}
mae <- function(obs, pred)
{
	mean(abs(obs - pred))
}


mse <- function(obs, pred)
{
	mean((obs - pred)^2)
}

rmae <- function(obs, pred, mean.val) 
{  
	sum(abs(obs - pred)) / sum(abs(obs - mean.val))
}

rmse <- function(obs, pred, mean.val) 
{  
	sum((obs - pred)^2)/sum((obs - mean.val)^2)
}
```

Najprej se deklarira funkcije, ki se bojo uporabljale za ocenjevanje modelov.

MAE -> srednja absolutna napaka

MSE -> srednja kvadratna napaka

RMAE -> relativna srednja absolutna napak

RMSE -> relativna srednja kvadratna napaka




## IZBIRANJE ATRIBUTOV Z NAJVEČJIM VPLIVOM NA CILJNO/ODVISNO SPREMENLJIVKO 

```{r}
dataForRegression = subset(sortedDF, select = -c(norm_poraba, teden, UNIX, prev_temp, temp_teden))

dataForRegressionJan <- filter(dataForRegression, mesec == 1)
for (i in 1:ncol(dataForRegressionJan))
  dataForRegressionJan[,i] <- as.factor(dataForRegressionJan[,i])
```

Podatke za regresijo se vzame iz že urejenih podatkov "sortedDF" brez "norm_poraba" in se jih faktorizira. 

```{r}
library(CORElearn)

dataForRegressionJan = subset(dataForRegressionJan, select = -c(mesec))
sort(attrEval(poraba ~ ., dataForRegressionJan, "InfGain"),  decreasing = TRUE)
```
Preveri se kateri atributi največ pripomorejo pri napovedovanju ciljne spremenljivke. Izbere se najboljše, torej
tiste, ki imajo najvišjo oceno. Zaradi prevelike količine podatkov se preveri za vsak mesec posebej(npr. zgoraj za januar).

```{r}
dataForRegression = subset(dataForRegression, select = -c(vikend, padavine, regija, ura, namembnost, oblacnost))
summary(dataForRegression)
```

Množica podatkov se zmanjša na 10 atributov (poleg atributa "poraba"), ki najbolj pripomorejo k napovedovanju atributa "poraba".

```{r}
dataForRegressionAll <- sortedDF
```

Nastavi se še spremenljivka za vse podatke, ki bodo uporabljeni v regresiji.




## EVALVACIJA MODELOV PO MESECIH (REGRESIJA) 

```{r}
podatki <- list()
```

List "podatki" bo držal vse podatke za kasnejšo primerjavo.

## FEBRUAR 

```{r}
dataForRegressionJanAll = filter(dataForRegressionAll, mesec == 1)
dataForRegressionFebAll = filter(dataForRegressionAll, mesec == 2)

dataForTrainAll <- dataForRegressionJanAll
dataForTestAll <- dataForRegressionFebAll

trainAll <- dataForTrainAll
testAll <- dataForTestAll
```

```{r}
dataForRegressionJan = subset(filter(dataForRegression, mesec == 1), select = -c(mesec))
dataForRegressionFeb = subset(filter(dataForRegression, mesec == 2), select = -c(mesec))

dataForTrain <- dataForRegressionJan
dataForTest <- dataForRegressionFeb

train <- dataForTrain
test <- dataForTest
```

Nastavi se učne in testne podatke. V tem primeru bomo testirali modele narejene iz januarskih podatkov na februarskih podatkih. Zgornji odlomek kode predstavlja vse podatke, spodnji pa le izbrane atribute.

### LINEARNA REGRESIJA 

#### Vsi podatki

```{r}
model <- lm(poraba ~ ., trainAll)
predicted <- predict(model, testAll)
observed <- testAll$poraba

podatki[[1]] <- c(mae(observed, predicted), sqrt(mse(observed, predicted)), rmae(observed, predicted, mean(trainAll$poraba)), rmse(observed, predicted, mean(trainAll$poraba)))
cat("\014")

plot(observed)
points(predicted, col="red")
```

#### Izbrani podatki

```{r}
model <- lm(poraba ~ ., train)
predicted <- predict(model, test)
observed <- test$poraba

podatki[[2]] <- c(mae(observed, predicted), sqrt(mse(observed, predicted)), rmae(observed, predicted, mean(train$poraba)), rmse(observed, predicted, mean(train$poraba)))
cat("\014")

plot(observed)
points(predicted, col="red")
```

### REGRESIJSKO DREVO 

#### Vsi podatki

```{r}
rt.model <- rpart(poraba ~ ., data=trainAll)
rpart.plot(rt.model)
predicted <- predict(rt.model, testAll)

podatki[[3]] <- c(mae(testAll$poraba, predicted), rmae(testAll$poraba, predicted, mean(trainAll$poraba)))
cat("\014")
```

#### Izbrani podatki

```{r}
rt.model <- rpart(poraba ~ ., data=train)
rpart.plot(rt.model)
predicted <- predict(rt.model, test)

podatki[[4]] <- c(mae(test$poraba, predicted), rmae(test$poraba, predicted, mean(train$poraba)))
cat("\014")
```

### NAKLJUČNI GOZD

#### Vsi podatki

```{r}
rf.model <- randomForest(poraba ~ ., trainAll, ntree=10, norm.votes=FALSE)
predicted <- predict(rf.model, testAll)

podatki[[5]] <- c(mae(testAll$poraba, predicted), rmae(testAll$poraba, predicted, mean(trainAll$poraba)))
cat("\014")
```

#### Izbrani podatki

```{r}
rf.model <- randomForest(poraba ~ ., train, ntree=10, norm.votes=FALSE)
predicted <- predict(rf.model, test)

podatki[[6]] <- c(mae(test$poraba, predicted), rmae(test$poraba, predicted, mean(train$poraba)))
cat("\014")
```




## MAREC 

```{r}
dataForRegressionFebAll = filter(dataForRegressionAll, mesec == 2)
dataForRegressionMarAll = filter(dataForRegressionAll, mesec == 3)

dataForTrainAll <- rbind(dataForTrainAll, dataForRegressionFebAll)

trainAll <- dataForTrainAll
testAll <- dataForRegressionMarAll
```

```{r}
dataForRegressionFeb = subset(filter(dataForRegression, mesec == 2), select = -c(mesec))
dataForRegressionMar = subset(filter(dataForRegression, mesec == 3), select = -c(mesec))

dataForTrain <- rbind(dataForTrain, dataForRegressionFeb)

train <- dataForTrain
test <- dataForRegressionMar
```

Nastavi se učne in testne podatke. V tem primeru bomo testirali modele narejene iz vseh dosedanjih + februarskih testirali na marčevskih podatkih. Zgornji odlomek kode predstavlja vse podatke, spodnji pa le izbrane atribute.

### LINEARNA REGRESIJA 

#### Vsi podatki

```{r}
model <- lm(poraba ~ ., trainAll)
predicted <- predict(model, testAll)
observed <- testAll$poraba

podatki[[7]] <- c(mae(observed, predicted), sqrt(mse(observed, predicted)), rmae(observed, predicted, mean(trainAll$poraba)), rmse(observed, predicted, mean(trainAll$poraba)))
cat("\014")

plot(observed)
points(predicted, col="red")
```

#### Izbrani podatki

```{r}
model <- lm(poraba ~ ., train)
predicted <- predict(model, test)
observed <- test$poraba

podatki[[8]] <- c(mae(observed, predicted), sqrt(mse(observed, predicted)), rmae(observed, predicted, mean(train$poraba)), rmse(observed, predicted, mean(train$poraba)))
cat("\014")

plot(observed)
points(predicted, col="red")
```

### REGRESIJSKO DREVO

#### Vsi podatki

```{r}
rt.model <- rpart(poraba ~ ., data=trainAll)
rpart.plot(rt.model)
predicted <- predict(rt.model, testAll)

podatki[[9]] <- c(mae(testAll$poraba, predicted), rmae(testAll$poraba, predicted, mean(trainAll$poraba)))
cat("\014")
```

#### Izbrani podatki

```{r}
rt.model <- rpart(poraba ~ ., data=train)
rpart.plot(rt.model)
predicted <- predict(rt.model, test)

podatki[[10]] <- c(mae(test$poraba, predicted), rmae(test$poraba, predicted, mean(train$poraba)))
cat("\014")
```

### NAKLJUČNI GOZD

#### Vsi podatki

```{r}
rf.model <- randomForest(poraba ~ ., trainAll, ntree=10, norm.votes=FALSE)
predicted <- predict(rf.model, testAll)

podatki[[11]] <- c(mae(testAll$poraba, predicted), rmae(testAll$poraba, predicted, mean(trainAll$poraba)))
cat("\014")
```

#### Izbrani podatki

```{r}
rf.model <- randomForest(poraba ~ ., train, ntree=10, norm.votes=FALSE)
predicted <- predict(rf.model, test)

podatki[[12]] <- c(mae(test$poraba, predicted), rmae(test$poraba, predicted, mean(train$poraba)))
cat("\014")
```




## APRIL 

```{r}
dataForRegressionMarAll = filter(dataForRegressionAll, mesec == 3)
dataForRegressionAprAll = filter(dataForRegressionAll, mesec == 4)

dataForTrainAll <- rbind(dataForTrainAll, dataForRegressionMarAll)

trainAll <- dataForTrainAll
testAll <- dataForRegressionAprAll
```

```{r}
dataForRegressionMar = subset(filter(dataForRegression, mesec == 3), select = -c(mesec))
dataForRegressionApr = subset(filter(dataForRegression, mesec == 4), select = -c(mesec))

dataForTrain <- rbind(dataForTrain, dataForRegressionMar)

train <- dataForTrain
test <- dataForRegressionApr
```

Nastavi se učne in testne podatke. V tem primeru bomo testirali modele narejene iz vseh dosedanjih + marčevskih testirali na aprilskih podatkih. Zgornji odlomek kode predstavlja vse podatke, spodnji pa le izbrane atribute.

### LINEARNA REGRESIJA 

#### Vsi podatki

```{r}
model <- lm(poraba ~ ., trainAll)
predicted <- predict(model, testAll)
observed <- testAll$poraba

podatki[[13]] <- c(mae(observed, predicted), sqrt(mse(observed, predicted)), rmae(observed, predicted, mean(trainAll$poraba)), rmse(observed, predicted, mean(trainAll$poraba)))
cat("\014")

plot(observed)
points(predicted, col="red")
```

#### Izbrani podatki

```{r}
model <- lm(poraba ~ ., train)
predicted <- predict(model, test)
observed <- test$poraba

podatki[[14]] <- c(mae(observed, predicted), sqrt(mse(observed, predicted)), rmae(observed, predicted, mean(train$poraba)), rmse(observed, predicted, mean(train$poraba)))
cat("\014")

plot(observed)
points(predicted, col="red")
```

### REGRESIJSKO DREVO

#### Vsi podatki

```{r}
rt.model <- rpart(poraba ~ ., data=trainAll)
rpart.plot(rt.model)
predicted <- predict(rt.model, testAll)

podatki[[15]] <- c(mae(testAll$poraba, predicted), rmae(testAll$poraba, predicted, mean(trainAll$poraba)))
cat("\014")
```

#### Izbrani podatki

```{r}
rt.model <- rpart(poraba ~ ., data=train)
rpart.plot(rt.model)
predicted <- predict(rt.model, test)

podatki[[16]] <- c(mae(test$poraba, predicted), rmae(test$poraba, predicted, mean(train$poraba)))
cat("\014")
```

### NAKLJUČNI GOZD

#### Vsi podatki

```{r}
rf.model <- randomForest(poraba ~ ., trainAll, ntree=10, norm.votes=FALSE)
predicted <- predict(rf.model, testAll)

podatki[[17]] <- c(mae(testAll$poraba, predicted), rmae(testAll$poraba, predicted, mean(trainAll$poraba)))
cat("\014")
```

#### Izbrani podatki

```{r}
rf.model <- randomForest(poraba ~ ., train, ntree=10, norm.votes=FALSE)
predicted <- predict(rf.model, test)

podatki[[18]] <- c(mae(test$poraba, predicted), rmae(test$poraba, predicted, mean(train$poraba)))
cat("\014")
```




## MAJ 


```{r}
dataForRegressionAprAll = filter(dataForRegressionAll, mesec == 4)
dataForRegressionMayAll = filter(dataForRegressionAll, mesec == 5)

dataForTrainAll <- rbind(dataForTrainAll, dataForRegressionAprAll)

trainAll <- dataForTrainAll
testAll <- dataForRegressionMayAll
```

```{r}
dataForRegressionApr = subset(filter(dataForRegression, mesec == 4), select = -c(mesec))
dataForRegressionMay = subset(filter(dataForRegression, mesec == 5), select = -c(mesec))

dataForTrain <- rbind(dataForTrain, dataForRegressionApr)

train <- dataForTrain
test <- dataForRegressionMay
```

Nastavi se učne in testne podatke. V tem primeru bomo testirali modele narejene iz vseh dosedanjih + aprilskih testirali na majevih podatkih. Zgornji odlomek kode predstavlja vse podatke, spodnji pa le izbrane atribute.

### LINEARNA REGRESIJA 

#### Vsi podatki

```{r}
model <- lm(poraba ~ ., trainAll)
predicted <- predict(model, testAll)
observed <- testAll$poraba

podatki[[19]] <- c(mae(observed, predicted), sqrt(mse(observed, predicted)), rmae(observed, predicted, mean(trainAll$poraba)), rmse(observed, predicted, mean(trainAll$poraba)))
cat("\014")

plot(observed)
points(predicted, col="red")
```

#### Izbrani podatki

```{r}
model <- lm(poraba ~ ., train)
predicted <- predict(model, test)
observed <- test$poraba

podatki[[20]] <- c(mae(observed, predicted), sqrt(mse(observed, predicted)), rmae(observed, predicted, mean(train$poraba)), rmse(observed, predicted, mean(train$poraba)))
cat("\014")

plot(observed)
points(predicted, col="red")
```

### REGRESIJSKO DREVO

#### Vsi podatki

```{r}
rt.model <- rpart(poraba ~ ., data=trainAll)
rpart.plot(rt.model)
predicted <- predict(rt.model, testAll)

podatki[[21]] <- c(mae(testAll$poraba, predicted), rmae(testAll$poraba, predicted, mean(trainAll$poraba)))
cat("\014")
```

#### Izbrani podatki

```{r}
rt.model <- rpart(poraba ~ ., data=train)
rpart.plot(rt.model)
predicted <- predict(rt.model, test)

podatki[[22]] <- c(mae(test$poraba, predicted), rmae(test$poraba, predicted, mean(train$poraba)))
cat("\014")
```

### NAKLJUČNI GOZD

#### Vsi podatki

```{r}
rf.model <- randomForest(poraba ~ ., trainAll, ntree=10, norm.votes=FALSE)
predicted <- predict(rf.model, testAll)

podatki[[23]] <- c(mae(testAll$poraba, predicted), rmae(testAll$poraba, predicted, mean(trainAll$poraba)))
cat("\014")
```

#### Izbrani podatki

```{r}
rf.model <- randomForest(poraba ~ ., train, ntree=10, norm.votes=FALSE)
predicted <- predict(rf.model, test)

podatki[[24]] <- c(mae(test$poraba, predicted), rmae(test$poraba, predicted, mean(train$poraba)))
cat("\014")
```




## JUNIJ 

```{r}
dataForRegressionMayAll = filter(dataForRegressionAll, mesec == 5)
dataForRegressionJunAll = filter(dataForRegressionAll, mesec == 6)

dataForTrainAll <- rbind(dataForTrainAll, dataForRegressionMayAll)

trainAll <- dataForTrainAll
testAll <- dataForRegressionJunAll
```

```{r}
dataForRegressionMay = subset(filter(dataForRegression, mesec == 5), select = -c(mesec))
dataForRegressionJun = subset(filter(dataForRegression, mesec == 6), select = -c(mesec))

dataForTrain <- rbind(dataForTrain, dataForRegressionMay)

train <- dataForTrain
test <- dataForRegressionJun
```

Nastavi se učne in testne podatke. V tem primeru bomo testirali modele narejene iz vseh dosedanjih + majevih testirali na junijskih podatkih. Zgornji odlomek kode predstavlja vse podatke, spodnji pa le izbrane atribute.

### LINEARNA REGRESIJA 

#### Vsi podatki

```{r}
model <- lm(poraba ~ ., trainAll)
predicted <- predict(model, testAll)
observed <- testAll$poraba

podatki[[25]] <- c(mae(observed, predicted), sqrt(mse(observed, predicted)), rmae(observed, predicted, mean(trainAll$poraba)), rmse(observed, predicted, mean(trainAll$poraba)))
cat("\014")

plot(observed)
points(predicted, col="red")
```

#### Izbrani podatki

```{r}
model <- lm(poraba ~ ., train)
predicted <- predict(model, test)
observed <- test$poraba

podatki[[26]] <- c(mae(observed, predicted), sqrt(mse(observed, predicted)), rmae(observed, predicted, mean(train$poraba)), rmse(observed, predicted, mean(train$poraba)))
cat("\014")

plot(observed)
points(predicted, col="red")
```

### REGRESIJSKO DREVO

#### Vsi podatki

```{r}
rt.model <- rpart(poraba ~ ., data=trainAll)
rpart.plot(rt.model)
predicted <- predict(rt.model, testAll)

podatki[[27]] <- c(mae(testAll$poraba, predicted), rmae(testAll$poraba, predicted, mean(trainAll$poraba)))
cat("\014")
```

#### Izbrani podatki

```{r}
rt.model <- rpart(poraba ~ ., data=train)
rpart.plot(rt.model)
predicted <- predict(rt.model, test)

podatki[[28]] <- c(mae(test$poraba, predicted), rmae(test$poraba, predicted, mean(train$poraba)))
cat("\014")
```

### NAKLJUČNI GOZD

#### Vsi podatki

```{r}
rf.model <- randomForest(poraba ~ ., trainAll, ntree=10, norm.votes=FALSE)
predicted <- predict(rf.model, testAll)

podatki[[29]] <- c(mae(testAll$poraba, predicted), rmae(testAll$poraba, predicted, mean(trainAll$poraba)))
cat("\014")
```

#### Izbrani podatki

```{r}
rf.model <- randomForest(poraba ~ ., train, ntree=10, norm.votes=FALSE)
predicted <- predict(rf.model, test)

podatki[[30]] <- c(mae(test$poraba, predicted), rmae(test$poraba, predicted, mean(train$poraba)))
cat("\014")
```




## JULIJ 


```{r}
dataForRegressionJunAll = filter(dataForRegressionAll, mesec == 6)
dataForRegressionJulAll = filter(dataForRegressionAll, mesec == 7)

dataForTrainAll <- rbind(dataForTrainAll, dataForRegressionJunAll)

trainAll <- dataForTrainAll
testAll <- dataForRegressionJulAll
```

```{r}
dataForRegressionJun = subset(filter(dataForRegression, mesec == 6), select = -c(mesec))
dataForRegressionJul = subset(filter(dataForRegression, mesec == 7), select = -c(mesec))

dataForTrain <- rbind(dataForTrain, dataForRegressionJun)

train <- dataForTrain
test <- dataForRegressionJul
```

Nastavi se učne in testne podatke. V tem primeru bomo testirali modele narejene iz vseh dosedanjih + junijskih testirali na julijskih podatkih. Zgornji odlomek kode predstavlja vse podatke, spodnji pa le izbrane atribute.

### LINEARNA REGRESIJA 

#### Vsi podatki

```{r}
model <- lm(poraba ~ ., trainAll)
predicted <- predict(model, testAll)
observed <- testAll$poraba

podatki[[31]] <- c(mae(observed, predicted), sqrt(mse(observed, predicted)), rmae(observed, predicted, mean(trainAll$poraba)), rmse(observed, predicted, mean(trainAll$poraba)))
cat("\014")

plot(observed)
points(predicted, col="red")
```

#### Izbrani podatki

```{r}
model <- lm(poraba ~ ., train)
predicted <- predict(model, test)
observed <- test$poraba

podatki[[32]] <- c(mae(observed, predicted), sqrt(mse(observed, predicted)), rmae(observed, predicted, mean(train$poraba)), rmse(observed, predicted, mean(train$poraba)))
cat("\014")

plot(observed)
points(predicted, col="red")
```

### REGRESIJSKO DREVO

#### Vsi podatki

```{r}
rt.model <- rpart(poraba ~ ., data=trainAll)
rpart.plot(rt.model)
predicted <- predict(rt.model, testAll)

podatki[[33]] <- c(mae(testAll$poraba, predicted), rmae(testAll$poraba, predicted, mean(trainAll$poraba)))
cat("\014")
```

#### Izbrani podatki

```{r}
rt.model <- rpart(poraba ~ ., data=train)
rpart.plot(rt.model)
predicted <- predict(rt.model, test)

podatki[[34]] <- c(mae(test$poraba, predicted), rmae(test$poraba, predicted, mean(train$poraba)))
cat("\014")
```

### NAKLJUČNI GOZD

#### Vsi podatki

```{r}
rf.model <- randomForest(poraba ~ ., trainAll, ntree=10, norm.votes=FALSE)
predicted <- predict(rf.model, testAll)

podatki[[35]] <- c(mae(testAll$poraba, predicted), rmae(testAll$poraba, predicted, mean(trainAll$poraba)))
cat("\014")
```

#### Izbrani podatki

```{r}
rf.model <- randomForest(poraba ~ ., train, ntree=10, norm.votes=FALSE)
predicted <- predict(rf.model, test)

podatki[[36]] <- c(mae(test$poraba, predicted), rmae(test$poraba, predicted, mean(train$poraba)))
cat("\014")
```




## AUGUST 

```{r}
dataForRegressionJulAll = filter(dataForRegressionAll, mesec == 7)
dataForRegressionAugAll = filter(dataForRegressionAll, mesec == 8)

dataForTrainAll <- rbind(dataForTrainAll, dataForRegressionJulAll)

trainAll <- dataForTrainAll
testAll <- dataForRegressionAugAll
```

```{r}
dataForRegressionJul = subset(filter(dataForRegression, mesec == 7), select = -c(mesec))
dataForRegressionAug = subset(filter(dataForRegression, mesec == 8), select = -c(mesec))

dataForTrain <- rbind(dataForTrain, dataForRegressionJul)

train <- dataForTrain
test <- dataForRegressionAug
```

Nastavi se učne in testne podatke. V tem primeru bomo testirali modele narejene iz vseh dosedanjih + julijskih testirali na avgustovih podatkih. Zgornji odlomek kode predstavlja vse podatke, spodnji pa le izbrane atribute.

### LINEARNA REGRESIJA 

#### Vsi podatki

```{r}
model <- lm(poraba ~ ., trainAll)
predicted <- predict(model, testAll)
observed <- testAll$poraba

podatki[[37]] <- c(mae(observed, predicted), sqrt(mse(observed, predicted)), rmae(observed, predicted, mean(trainAll$poraba)), rmse(observed, predicted, mean(trainAll$poraba)))
cat("\014")

plot(observed)
points(predicted, col="red")
```

#### Izbrani podatki

```{r}
model <- lm(poraba ~ ., train)
predicted <- predict(model, test)
observed <- test$poraba

podatki[[38]] <- c(mae(observed, predicted), sqrt(mse(observed, predicted)), rmae(observed, predicted, mean(train$poraba)), rmse(observed, predicted, mean(train$poraba)))
cat("\014")

plot(observed)
points(predicted, col="red")
```

### REGRESIJSKO DREVO

#### Vsi podatki

```{r}
rt.model <- rpart(poraba ~ ., data=trainAll)
rpart.plot(rt.model)
predicted <- predict(rt.model, testAll)

podatki[[39]] <- c(mae(testAll$poraba, predicted), rmae(testAll$poraba, predicted, mean(trainAll$poraba)))
cat("\014")
```

#### Izbrani podatki

```{r}
rt.model <- rpart(poraba ~ ., data=train)
rpart.plot(rt.model)
predicted <- predict(rt.model, test)

podatki[[40]] <- c(mae(test$poraba, predicted), rmae(test$poraba, predicted, mean(train$poraba)))
cat("\014")
```

### NAKLJUČNI GOZD

#### Vsi podatki

```{r}
rf.model <- randomForest(poraba ~ ., trainAll, ntree=10, norm.votes=FALSE)
predicted <- predict(rf.model, testAll)

podatki[[41]] <- c(mae(testAll$poraba, predicted), rmae(testAll$poraba, predicted, mean(trainAll$poraba)))
cat("\014")
```

#### Izbrani podatki

```{r}
rf.model <- randomForest(poraba ~ ., train, ntree=10, norm.votes=FALSE)
predicted <- predict(rf.model, test)

podatki[[42]] <- c(mae(test$poraba, predicted), rmae(test$poraba, predicted, mean(train$poraba)))
cat("\014")
```




## SEPTEMBER 

```{r}
dataForRegressionAugAll = filter(dataForRegressionAll, mesec == 8)
dataForRegressionSepAll = filter(dataForRegressionAll, mesec == 9)

dataForTrainAll <- rbind(dataForTrainAll, dataForRegressionAugAll)

trainAll <- dataForTrainAll
testAll <- dataForRegressionSepAll
```

```{r}
dataForRegressionAug = subset(filter(dataForRegression, mesec == 8), select = -c(mesec))
dataForRegressionSep = subset(filter(dataForRegression, mesec == 9), select = -c(mesec))

dataForTrain <- rbind(dataForTrain, dataForRegressionAug)

train <- dataForTrain
test <- dataForRegressionSep
```

Nastavi se učne in testne podatke. V tem primeru bomo testirali modele narejene iz vseh dosedanjih + avgustovih testirali na septemrskih podatkih. Zgornji odlomek kode predstavlja vse podatke, spodnji pa le izbrane atribute.

### LINEARNA REGRESIJA 

#### Vsi podatki

```{r}
model <- lm(poraba ~ ., trainAll)
predicted <- predict(model, testAll)
observed <- testAll$poraba

podatki[[43]] <- c(mae(observed, predicted), sqrt(mse(observed, predicted)), rmae(observed, predicted, mean(trainAll$poraba)), rmse(observed, predicted, mean(trainAll$poraba)))
cat("\014")

plot(observed)
points(predicted, col="red")
```

#### Izbrani podatki

```{r}
model <- lm(poraba ~ ., train)
predicted <- predict(model, test)
observed <- test$poraba

podatki[[44]] <- c(mae(observed, predicted), sqrt(mse(observed, predicted)), rmae(observed, predicted, mean(train$poraba)), rmse(observed, predicted, mean(train$poraba)))
cat("\014")

plot(observed)
points(predicted, col="red")
```

### REGRESIJSKO DREVO

#### Vsi podatki

```{r}
rt.model <- rpart(poraba ~ ., data=trainAll)
rpart.plot(rt.model)
predicted <- predict(rt.model, testAll)

podatki[[45]] <- c(mae(testAll$poraba, predicted), rmae(testAll$poraba, predicted, mean(trainAll$poraba)))
cat("\014")
```

#### Izbrani podatki

```{r}
rt.model <- rpart(poraba ~ ., data=train)
rpart.plot(rt.model)
predicted <- predict(rt.model, test)

podatki[[46]] <- c(mae(test$poraba, predicted), rmae(test$poraba, predicted, mean(train$poraba)))
cat("\014")
```

### NAKLJUČNI GOZD

#### Vsi podatki

```{r}
rf.model <- randomForest(poraba ~ ., trainAll, ntree=10, norm.votes=FALSE)
predicted <- predict(rf.model, testAll)

podatki[[47]] <- c(mae(testAll$poraba, predicted), rmae(testAll$poraba, predicted, mean(trainAll$poraba)))
cat("\014")
```

#### Izbrani podatki

```{r}
rf.model <- randomForest(poraba ~ ., train, ntree=10, norm.votes=FALSE)
predicted <- predict(rf.model, test)

podatki[[48]] <- c(mae(test$poraba, predicted), rmae(test$poraba, predicted, mean(train$poraba)))
cat("\014")
```




## OKTOBER 

```{r}
dataForRegressionSepAll = filter(dataForRegressionAll, mesec == 9)
dataForRegressionOctAll = filter(dataForRegressionAll, mesec == 10)

dataForTrainAll <- rbind(dataForTrainAll, dataForRegressionSepAll)

trainAll <- dataForTrainAll
testAll <- dataForRegressionOctAll
```

```{r}
dataForRegressionSep = subset(filter(dataForRegression, mesec == 9), select = -c(mesec))
dataForRegressionOct = subset(filter(dataForRegression, mesec == 10), select = -c(mesec))

dataForTrain <- rbind(dataForTrain, dataForRegressionSep)

train <- dataForTrain
test <- dataForRegressionOct
```

Nastavi se učne in testne podatke. V tem primeru bomo testirali modele narejene iz vseh dosedanjih + septembrskih testirali na oktobrskih podatkih. Zgornji odlomek kode predstavlja vse podatke, spodnji pa le izbrane atribute.

### LINEARNA REGRESIJA 

#### Vsi podatki

```{r}
model <- lm(poraba ~ ., trainAll)
predicted <- predict(model, testAll)
observed <- testAll$poraba

podatki[[49]] <- c(mae(observed, predicted), sqrt(mse(observed, predicted)), rmae(observed, predicted, mean(trainAll$poraba)), rmse(observed, predicted, mean(trainAll$poraba)))
cat("\014")

plot(observed)
points(predicted, col="red")
```

#### Izbrani podatki

```{r}
model <- lm(poraba ~ ., train)
predicted <- predict(model, test)
observed <- test$poraba

podatki[[50]] <- c(mae(observed, predicted), sqrt(mse(observed, predicted)), rmae(observed, predicted, mean(train$poraba)), rmse(observed, predicted, mean(train$poraba)))
cat("\014")

plot(observed)
points(predicted, col="red")
```

### REGRESIJSKO DREVO

#### Vsi podatki

```{r}
rt.model <- rpart(poraba ~ ., data=trainAll)
rpart.plot(rt.model)
predicted <- predict(rt.model, testAll)

podatki[[51]] <- c(mae(testAll$poraba, predicted), rmae(testAll$poraba, predicted, mean(trainAll$poraba)))
cat("\014")
```

#### Izbrani podatki

```{r}
rt.model <- rpart(poraba ~ ., data=train)
rpart.plot(rt.model)
predicted <- predict(rt.model, test)

podatki[[52]] <- c(mae(test$poraba, predicted), rmae(test$poraba, predicted, mean(train$poraba)))
cat("\014")
```

### NAKLJUČNI GOZD

#### Vsi podatki

```{r}
rf.model <- randomForest(poraba ~ ., trainAll, ntree=10, norm.votes=FALSE)
predicted <- predict(rf.model, testAll)

podatki[[53]] <- c(mae(testAll$poraba, predicted), rmae(testAll$poraba, predicted, mean(trainAll$poraba)))
cat("\014")
```

#### Izbrani podatki

```{r}
rf.model <- randomForest(poraba ~ ., train, ntree=10, norm.votes=FALSE)
predicted <- predict(rf.model, test)

podatki[[54]] <- c(mae(test$poraba, predicted), rmae(test$poraba, predicted, mean(train$poraba)))
cat("\014")
```




## NOVEMBER 

```{r}
dataForRegressionOctAll = filter(dataForRegressionAll, mesec == 10)
dataForRegressionNovAll = filter(dataForRegressionAll, mesec == 11)

dataForTrainAll <- rbind(dataForTrainAll, dataForRegressionOctAll)

trainAll <- dataForTrainAll
testAll <- dataForRegressionNovAll
```

```{r}
dataForRegressionOct = subset(filter(dataForRegression, mesec == 10), select = -c(mesec))
dataForRegressionNov = subset(filter(dataForRegression, mesec == 11), select = -c(mesec))

dataForTrain <- rbind(dataForTrain, dataForRegressionOct)

train <- dataForTrain
test <- dataForRegressionNov
```

Nastavi se učne in testne podatke. V tem primeru bomo testirali modele narejene iz vseh dosedanjih + oktobrskih testirali na novembrskih podatkih. Zgornji odlomek kode predstavlja vse podatke, spodnji pa le izbrane atribute.

### LINEARNA REGRESIJA 

#### Vsi podatki

```{r}
model <- lm(poraba ~ ., trainAll)
predicted <- predict(model, testAll)
observed <- testAll$poraba

podatki[[55]] <- c(mae(observed, predicted), sqrt(mse(observed, predicted)), rmae(observed, predicted, mean(trainAll$poraba)), rmse(observed, predicted, mean(trainAll$poraba)))
cat("\014")

plot(observed)
points(predicted, col="red")
```

#### Izbrani podatki

```{r}
model <- lm(poraba ~ ., train)
predicted <- predict(model, test)
observed <- test$poraba

podatki[[56]] <- c(mae(observed, predicted), sqrt(mse(observed, predicted)), rmae(observed, predicted, mean(train$poraba)), rmse(observed, predicted, mean(train$poraba)))
cat("\014")

plot(observed)
points(predicted, col="red")
```

### REGRESIJSKO DREVO

#### Vsi podatki

```{r}
rt.model <- rpart(poraba ~ ., data=trainAll)
rpart.plot(rt.model)
predicted <- predict(rt.model, testAll)

podatki[[57]] <- c(mae(testAll$poraba, predicted), rmae(testAll$poraba, predicted, mean(trainAll$poraba)))
cat("\014")
```

#### Izbrani podatki

```{r}
rt.model <- rpart(poraba ~ ., data=train)
rpart.plot(rt.model)
predicted <- predict(rt.model, test)

podatki[[58]] <- c(mae(test$poraba, predicted), rmae(test$poraba, predicted, mean(train$poraba)))
cat("\014")
```

### NAKLJUČNI GOZD

#### Vsi podatki

```{r}
rf.model <- randomForest(poraba ~ ., trainAll, ntree=10, norm.votes=FALSE)
predicted <- predict(rf.model, testAll)

podatki[[59]] <- c(mae(testAll$poraba, predicted), rmae(testAll$poraba, predicted, mean(trainAll$poraba)))
cat("\014")
```

#### Izbrani podatki

```{r}
rf.model <- randomForest(poraba ~ ., train, ntree=10, norm.votes=FALSE)
predicted <- predict(rf.model, test)

podatki[[60]] <- c(mae(test$poraba, predicted), rmae(test$poraba, predicted, mean(train$poraba)))
cat("\014")
```




## DECEMBER 

```{r}
dataForRegressionNovAll = filter(dataForRegressionAll, mesec == 11)
dataForRegressionDecAll = filter(dataForRegressionAll, mesec == 12)

dataForTrainAll <- rbind(dataForTrainAll, dataForRegressionNovAll)

trainAll <- dataForTrainAll
testAll <- dataForRegressionDecAll
```

```{r}
dataForRegressionNov = subset(filter(dataForRegression, mesec == 11), select = -c(mesec))
dataForRegressionDec = subset(filter(dataForRegression, mesec == 12), select = -c(mesec))

dataForTrain <- rbind(dataForTrain, dataForRegressionNov)

train <- dataForTrain
test <- dataForRegressionDec
```

Nastavi se učne in testne podatke. V tem primeru bomo testirali modele narejene iz vseh dosedanjih + novembrskih testirali na decembrskih podatkih. Zgornji odlomek kode predstavlja vse podatke, spodnji pa le izbrane atribute.

### LINEARNA REGRESIJA 

#### Vsi podatki

```{r}
model <- lm(poraba ~ ., trainAll)
predicted <- predict(model, testAll)
observed <- testAll$poraba

podatki[[61]] <- c(mae(observed, predicted), sqrt(mse(observed, predicted)), rmae(observed, predicted, mean(trainAll$poraba)), rmse(observed, predicted, mean(trainAll$poraba)))
cat("\014")

plot(observed)
points(predicted, col="red")
```

#### Izbrani podatki

```{r}
model <- lm(poraba ~ ., train)
predicted <- predict(model, test)
observed <- test$poraba

podatki[[62]] <- c(mae(observed, predicted), sqrt(mse(observed, predicted)), rmae(observed, predicted, mean(train$poraba)), rmse(observed, predicted, mean(train$poraba)))
cat("\014")

plot(observed)
points(predicted, col="red")
```

### REGRESIJSKO DREVO

#### Vsi podatki

```{r}
rt.model <- rpart(poraba ~ ., data=trainAll)
rpart.plot(rt.model)
predicted <- predict(rt.model, testAll)

podatki[[63]] <- c(mae(testAll$poraba, predicted), rmae(testAll$poraba, predicted, mean(trainAll$poraba)))
cat("\014")
```

#### Izbrani podatki

```{r}
rt.model <- rpart(poraba ~ ., data=train)
rpart.plot(rt.model)
predicted <- predict(rt.model, test)

podatki[[64]] <- c(mae(test$poraba, predicted), rmae(test$poraba, predicted, mean(train$poraba)))
cat("\014")
```

### NAKLJUČNI GOZD

#### Vsi podatki

```{r}
rf.model <- randomForest(poraba ~ ., trainAll, ntree=10, norm.votes=FALSE)
predicted <- predict(rf.model, testAll)

podatki[[65]] <- c(mae(testAll$poraba, predicted), rmae(testAll$poraba, predicted, mean(trainAll$poraba)))
cat("\014")
```

#### Izbrani podatki

```{r}
rf.model <- randomForest(poraba ~ ., train, ntree=10, norm.votes=FALSE)
predicted <- predict(rf.model, test)

podatki[[66]] <- c(mae(test$poraba, predicted), rmae(test$poraba, predicted, mean(train$poraba)))
cat("\014")
```


# PRIKAZ PODATKOV REGRESIJE

## LINEARNA REGRESIJA

```{r}
podatkiRegresija <- read.csv("../../AI-naloga/podatkiRegresija.txt", stringsAsFactors=TRUE)
podatkiRegresijaLinearna = filter(podatkiRegresija, model == "linearna_regresija")
podatkiRegresijaLinearnaMae = filter(podatkiRegresijaLinearna, vrsta_napake == "mae")
podatkiRegresijaLinearnaMaeVsi = filter(podatkiRegresijaLinearnaMae, kolicina_podatkov == "vsi")
podatkiRegresijaLinearnaMaeIzbrani = filter(podatkiRegresijaLinearnaMae, kolicina_podatkov == "izbrani")

plot(order(podatkiRegresijaLinearnaMaeVsi$mesec), podatkiRegresijaLinearnaMaeVsi$napaka,main="VSI PODATKI - LINEARNA REGRESIJA", xlab="MESECI", ylab="SREDNJA ABSOLUTNA NAPAKA", type = "h")
plot(order(podatkiRegresijaLinearnaMaeIzbrani$mesec), podatkiRegresijaLinearnaMaeIzbrani$napaka,main="IZBRANI PODATKI - LINEARNA REGRESIJA", xlab="MESECI", ylab="SREDNJA ABSOLUTNA NAPAKA", type = "h")
```

